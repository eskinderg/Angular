<nav class="menu">
    <ul>
        <a class="brand" [routerLink]="['/home']">Angular</a>
        @if (IsLoggedIn | async) {
            <div class="menu-logged-in">
                <li>
                    <a
                        [routerLinkActive]="['active-link']"
                        [routerLinkActiveOptions]="{ exact: true }"
                        [routerLink]="['/home']">
                        Home
                    </a>
                </li>
                <li>
                    <a
                        [routerLinkActive]="['active-link']"
                        [routerLinkActiveOptions]="{ exact: false }"
                        [routerLink]="['/about']">
                        About
                    </a>
                </li>
                <li>
                    <a
                        [routerLinkActive]="['active-link']"
                        [routerLinkActiveOptions]="{ exact: true }"
                        [routerLink]="['/profile']">
                        Profile
                    </a>
                </li>
                <li>
                    <a
                        [ngClass]="{ active: isNotesURLActive }"
                        aria-expanded="false"
                        [routerLink]="['/notes']"
                        [routerLinkActive]="['active-link']"
                        [routerLinkActiveOptions]="{ exact: false }">
                        Notes
                        @if (NoteLoading | async) {
                            <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                        } @else {
                            @if (NotesCount | async; as count) {
                                <span class="badge bg-secondary">{{ count }}</span>
                            }
                        }
                    </a>

                    <ul>
                        <li>
                            <a
                                [routerLink]="['/notes/mynotes']"
                                [routerLinkActive]="['active-link']"
                                [routerLinkActiveOptions]="{ exact: true }">
                                Notes
                            </a>
                        </li>
                        <li>
                            <a
                                [routerLink]="['/notes/archived']"
                                [routerLinkActive]="['active-link']"
                                [routerLinkActiveOptions]="{ exact: false }">
                                Archived Notes
                            </a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a
                        [routerLinkActive]="['active-link']"
                        [routerLinkActiveOptions]="{ exact: false }"
                        [routerLink]="['/wizard']">
                        Wizard
                    </a>
                </li>
                <li>
                    <a
                        [routerLinkActive]="['active-link']"
                        [routerLinkActiveOptions]="{ exact: false }"
                        [routerLink]="['/events']">
                        Events
                        @if (EventLoading | async) {
                            <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                        } @else {
                            @if (EventsCount | async; as count) {
                                <span class="badge bg-secondary">{{ count }}</span>
                            }
                        }
                    </a>
                </li>
                <li>
                    <a
                        [routerLinkActive]="['active-link']"
                        [routerLinkActiveOptions]="{ exact: false }"
                        [routerLink]="['/movies']">
                        Movies
                    </a>
                    @if (IsLoggedIn | async) {
                        <ul>
                            <li>
                                <a
                                    [routerLink]="['/movies/watchlist']"
                                    [routerLinkActive]="['active-link']"
                                    [routerLinkActiveOptions]="{ exact: true }">
                                    Watch List &nbsp;
                                    @if (WatchListCount | async; as count) {
                                        <span class="badge bg-secondary">{{ count }}</span>
                                    }
                                </a>
                            </li>
                            <li>
                                <a
                                    [routerLink]="['/movies/search']"
                                    [routerLinkActive]="['active-link']"
                                    [routerLinkActiveOptions]="{ exact: true }"
                                    style="display: flex; gap: 8px">
                                    Search
                                    <app-svg-icon
                                        class="search-icon"
                                        height="25"
                                        width="25"
                                        src="assets/images/search.svg"></app-svg-icon>
                                </a>
                            </li>
                            <li>
                                <a
                                    [routerLink]="['/movies/history']"
                                    [routerLinkActive]="['active-link']"
                                    [routerLinkActiveOptions]="{ exact: true }"
                                    style="display: flex; gap: 8px">
                                    History
                                    @if (WatchedListCount | async; as count) {
                                        <span class="badge bg-secondary">{{ count }}</span>
                                    }
                                </a>
                            </li>
                        </ul>
                    }
                </li>
            </div>
            @if (permission.IsAdmin) {
                <div class="dashboard">
                    <li>
                        <a
                            [routerLinkActive]="['active-link']"
                            [routerLinkActiveOptions]="{ exact: true }"
                            [routerLink]="['/admin/dashboard']">
                            Dashboard
                        </a>
                    </li>
                </div>
                <div class="">
                    <li>
                        <a
                            [routerLinkActive]="['active-link']"
                            [routerLinkActiveOptions]="{ exact: true }"
                            [routerLink]="['/admin/users']">
                            Users
                        </a>
                    </li>
                </div>
            }
        }

        <app-userinfo class="user-info" (signout)="onSignout()"></app-userinfo>
    </ul>
</nav>
